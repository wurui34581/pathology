# pathology

## 开发构建

### 目录结构 

```bash
├── /dist/           # 项目输出目录
├── /mock/           # 数据mock
├── /public/         # 公共文件，编译时copy至dist目录
├── /src/            # 项目源码目录
│ ├── /components/   # UI组件及UI相关方法
│ ├── /layouts/      # 全局组件
│ │ └── app.js       # 页面入口
│ │ └── index.js     # 入口文件
│ ├── /models/       # 数据模型
│ ├── /pages/        # 页面组件
│ │ └── document.ejs # html模版
│ ├── /services/     # 数据接口
│ ├── /themes/       # 项目样式
│ │ ├── default.less # 全局样式
│ │ └── vars.less    # 全局样式变量
│ ├── /utils/        # 工具函数
│ │ ├── config.js    # 项目常规配置
│ │ ├── menu.js      # 菜单及面包屑配置
│ │ ├── config.js    # 项目常规配置
│ │ ├── request.js   # 异步请求函数(axios)
│ │ └── theme.js     # 项目需要在js中使用到样式变量
├── package.json     # 项目信息
├── .eslintrc        # Eslint配置
└── .umirc.js        # umi配置
└── .umirc.mock.js   # mock配置
└── .theme.config.js # 主题less编译配置
```

文件夹命名说明:

* components：组件（方法）为单位以文件夹保存，文件夹名组件首字母大写（如`DataTable`），方法首字母小写（如`layer`）,文件夹内主文件与文件夹同名，多文件以`index.js`导出对象（如`./src/components/Layout`）。
* routes：页面为单位以文件夹保存，文件夹名首字母小写（特殊除外，如`UIElement`）,文件夹内主文件以`index.js`导出，多文件时可建立`components`文件夹（如`./src/routes/dashboard`），如果有子路由，依次按照路由层次建立文件夹（如`./src/routes/UIElement`）。

### 快速开始

克隆项目文件:

```bash
git clone https://github.com/zuiidea/antd-admin.git
```

进入目录安装依赖:

```bash
#开始前请确保没有安装roadhog、webpack到NPM全局目录, 国内用户推荐yarn或者cnpm
npm i 或者 yarn install
```

开发：

```bash
npm run start
打开 http://localhost:8000 #端口在package.json中cross-env后加上 PORT=8000指定
```


接口说明

1./upload
方法：POST
作用：上传文件夹
提交示例：
[{name:'folderName/fileName'}]

2./patients
方法：GET
作用：获取患者（文件）列表以及相应的算法数据
Response:
{
  id: 'patientId',                                                                                                                //患者（文件）ID
  name: 'fileName',                                                                                                               //文件名
  dzi_path: '/dzi_path/123.dzi',                                                                                                  //dzi文件地址
  width: 54321,                                                                                                                   //整图的宽
  height: 12345,                                                                                                                  //整图的高
  check: false,                                                                                                                   //医生审核状态（已审核：true，未审核：false）
  conclusion: "abnormal",                                                                                                         //整图结论（abnormal: 异常，normal：正常）
  probability: 34.33333,                                                                                                          //整图平均阳性概率
  cancerAreas_number: 2,                                                                                                          //疑似癌症区域个数
  cancerAreas_percent: 23.3333,                                                                                                   //疑似患癌面积所占百分比
  roi_path: "/database/result/2018-10-09 19_56_44/roi.jpg",                                                                       //roi图片地址
  heatmap_path: "/database/result/2018-10-09 19_56_44/heatmap.jpg",                                                               //heatmap图片地址
  result: {
    annotation: "M51.18490727516663 82.16866761106219 L55.124575423826485 80.52426650815163 
                L57.09440949815641 78.87986540524108 L68.91341394413595 67.36905768486714 L70.88324801846588 64.08025547904602 
                L70.88324801846588 60.842840807690834 L66.94357986980603 41.110027572764075 L55.124575423826485 26.310417646569007 
                L47.24523912650678 23.021615440747883 L39.365902829187085 21.377214337837323 L35.45701333793865 21.377214337837323 
                L29.547511114948865 24.666016543658447 L19.698340743299248 31.2436209553007 L11.819004445979548 50.97643419022746 
                L11.819004445979548 52.59514152590504 L17.728506668969324 67.36905768486714 L19.698340743299248 70.65785989068826 
                L25.60784296628902 78.87986540524108 L29.547511114948865 82.16866761106219 L51.18490727516663 82.16866761106219"   //标记坐标值
    area: 20.1081319353,                                                                                                           //疑似患癌区域面积
    area_center: {
      x: 41.3511262322,                                                                                                            //区域中心x值
      y: 62.018994684                                                                                                              //区域中心Y值
    },
    area_id: 0,                                                                                                                    //区域编号
    conclusion: "abnormal"                                                                                                         //区域结论
  }
}

3./labels
方法：POST
作用：保存所有医生标记
提交示例：
[{
  anno: "M51.18490727516663 82.16866761106219 L55.124575423826485 80.52426650815163 
         L57.09440949815641 78.87986540524108 L68.91341394413595 67.36905768486714 L70.88324801846588 64.08025547904602 
         L70.88324801846588 60.842840807690834 L66.94357986980603 41.110027572764075 L55.124575423826485 26.310417646569007 
         L47.24523912650678 23.021615440747883 L39.365902829187085 21.377214337837323 L35.45701333793865 21.377214337837323 
         L29.547511114948865 24.666016543658447 L19.698340743299248 31.2436209553007 L11.819004445979548 50.97643419022746 
         L11.819004445979548 52.59514152590504 L17.728506668969324 67.36905768486714 L19.698340743299248 70.65785989068826 
         L25.60784296628902 78.87986540524108 L29.547511114948865 82.16866761106219 L51.18490727516663 82.16866761106219"           //标记坐标值
  anno_id: 0,                                                                                                                       //标记ID
  width: 12345,                                                                                                                     //整图宽
  height: 54321,                                                                                                                    //整图高
  id: "wertt",                                                                                                                      //患者（文件）ID
  type: "2"                                                                                                                         //标注区域结论
}]


4./conclusion_all
方法：POST
作用：保存医生确认结果
提交示例：
[{
  id: "2018-09-28 00_25_32",                                                                                                        //患者（文件）ID
  type: "benign"                                                                                                                    //整图结论
}]





